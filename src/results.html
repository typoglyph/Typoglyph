<!DOCTYPE html>
<html>
<head>
	<meta content="text/html;charset=utf-8" http-equiv="Content-Type">
	<meta content="utf-8" http-equiv="encoding">
	
	<!-- Only one of the dynamic styles will be enabled at once, based on the current size of the browser window -->
	<!-- @see scripts/dynamicStylesheets.js -->
	<link rel="stylesheet" type="text/css" href="styles/main.css">
	<link rel="stylesheet" type="text/css" href="styles/main-tiny.css"		class="dynamic-stylesheet max-width:768">
	<link rel="stylesheet" type="text/css" href="styles/main-small.css"		class="dynamic-stylesheet min-width:769		max-width:1280">
	<link rel="stylesheet" type="text/css" href="styles/main-medium.css"	class="dynamic-stylesheet min-width:1281	max-width:2048">
	<link rel="stylesheet" type="text/css" href="styles/main-large.css"		class="dynamic-stylesheet min-width:2049">
	
	<!-- see https://github.com/davidjbradshaw/iframe-resizer -->
	<script type="text/javascript" src="scripts/lib/iframe-resizer-v3.5.0/iframeResizer.contentWindow.min.js"></script>
	<script type="text/javascript" src="scripts/common.js"></script>
	<script type="text/javascript" src="scripts/util.js"></script>
	<script type="text/javascript" src="scripts/dynamicStylesheets.js"></script>
	<script>
	
	
	// Imports
	var DynamicStylesheets = typoglyph.DynamicStylesheets;
	
	
	// Global variables
	var _dynStylesheets = null;
	var _onNextPuzzleSetListener = null;
	
	
	// Visible to other pages (when this page is embeded inside another)
	/**
	 * @param {StatisticsTracker} statsTracker
	 */
	function showResults(statsTracker) {
		var allStats = statsTracker.getStatistics();
		var correctStats = statsTracker.getCorrectlyAnsweredStatistics();
		document.getElementById("correct").innerHTML = correctStats.length;
		document.getElementById("total").innerHTML = allStats.length;
	}
	
	/**
	 * @param {function(TouchEvent)} listener
	 */
	function setOnNextPuzzleSetListener(listener) {
		_onNextPuzzleSetListener = listener;
	}
	
	
	// Event handlers
	/**
	 * Called when the browser has finished (re)loading the document
	 */
	function onLoad() {
		console.debug("onLoad");
		_dynStylesheets = DynamicStylesheets.fromDocument(document);
		_dynStylesheets.update();
	}
	
	/**
	 * Called whenever the size of the viewport changes
	 * 
	 * @param {Event} event
	 */
	function onResize(event) {
		console.debug("onResize: event=" + event);
		_dynStylesheets.update();
	}
	
	/**
	 * Called whenever the orientation of the device changes. Note browser support is spotty - some
	 * may call onResize(), some may call onOrientationChange(), some may all both, some may not
	 * call either
	 */
	function onOrientationChange(event) {
		console.debug("onOrientationChange: event=" + event);
		_dynStylesheets.update();
	}
	
	/**
	 * @param {MouseEvent} event Information about the click event
	 * @param {HTMLElement} element The DOM element representing the button which was clicked
	 */
	function onNextPuzzleSetButtonClicked(event, element) {
		console.debug("onNextPuzzleSetButtonClicked: event=" + event + ", element=" + element);
		if (_onNextPuzzleSetListener !== null)
			_onNextPuzzleSetListener();
	}
	</script>
</head>
<body onload="onLoad();" onresize="onResize(event);" onorientationchange="onOrientationChange(event);">
	<table>
		<tr>
			<td>
				<h1>Results</h1>
				<p><span id="correct"></span> / <span id="total"></span></p>
			</td>
			<td class="buttonHolder">
				<img id="nextPuzzleSet" class="button" src="images/button_next_set.svg" onclick="onNextPuzzleSetButtonClicked(event, this);" />
			</td>
		</tr>
	</table>
</body>
</html>
